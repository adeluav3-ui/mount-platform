<!DOCTYPE html>
<html>

<head>
    <title>Mobile Debug</title>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
        }

        #log {
            background: #f0f0f0;
            padding: 10px;
            height: 300px;
            overflow-y: scroll;
            margin: 10px 0;
        }

        button {
            padding: 10px;
            margin: 5px;
            font-size: 16px;
        }
    </style>
</head>

<body>
    <h1>Mobile Debug Page</h1>

    <div id="log"></div>

    <button onclick="testClick()">Test Click</button>
    <button onclick="checkOneSignal()">Check OneSignal</button>
    <button onclick="requestPermission()">Request Permission</button>

    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js"></script>
    <script>
        const log = document.getElementById('log');

        function addLog(message) {
            const line = document.createElement('div');
            line.textContent = new Date().toLocaleTimeString() + ': ' + message;
            log.appendChild(line);
            log.scrollTop = log.scrollHeight;
        }

        // Initialize OneSignal
        window.OneSignalDeferred = window.OneSignalDeferred || [];

        OneSignalDeferred.push(async function (OneSignal) {
            window.OneSignal = OneSignal;

            await OneSignal.init({
                appId: "0186919f-3891-40a5-81b6-c9e70634bdef",
                autoRegister: false,
                notifyButton: { enable: false }
            });

            addLog('✅ OneSignal initialized');
            addLog('OneSignal object: ' + (OneSignal ? 'Loaded' : 'Not loaded'));
        });

        function testClick() {
            addLog('Test button clicked');
            alert('Test button works!');
        }

        async function checkOneSignal() {
            addLog('Checking OneSignal...');

            if (!window.OneSignal) {
                addLog('❌ OneSignal not loaded');
                alert('OneSignal not loaded');
                return;
            }

            addLog('✅ OneSignal loaded');
            addLog('Notifications object: ' + (window.OneSignal.Notifications ? 'Yes' : 'No'));

            // Check permission
            if (window.OneSignal.Notifications && window.OneSignal.Notifications.permissionNative) {
                const permission = await window.OneSignal.Notifications.permissionNative;
                addLog('Permission: ' + permission);
                alert('Permission: ' + permission);
            } else {
                addLog('❌ permissionNative not available');
            }
        }

        async function requestPermission() {
            addLog('Requesting permission...');

            if (!window.OneSignal || !window.OneSignal.Notifications || !window.OneSignal.Notifications.requestPermission) {
                addLog('❌ Cannot request permission - method not available');
                alert('Cannot request permission');
                return;
            }

            try {
                const permission = await window.OneSignal.Notifications.requestPermission();
                addLog('Permission result: ' + permission);
                alert('Permission: ' + permission);

                if (permission === 'granted') {
                    // Get Player ID
                    const playerId = await window.OneSignal.getUserId();
                    addLog('Player ID: ' + (playerId || 'Not set'));
                    alert('Player ID: ' + (playerId || 'Not set'));
                }
            } catch (error) {
                addLog('❌ Error: ' + error.message);
                alert('Error: ' + error.message);
            }
        }

        addLog('Page loaded');
    </script>
</body>

</html>